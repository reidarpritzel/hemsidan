/**
 * Encodes an RGBA image to a PNG data URI. RGB should not be premultiplied by A.
 *
 * @remarks
 * This is optimized for speed and simplicity and does not optimize for size
 * at all. This does not do any compression (all values are stored uncompressed).
 *
 * @see https://github.com/evanw/thumbhash
 * @author Evan Wallace
 * @license MIT
 */function pt(t,e,o){const s=t*4+1,r=6+e*(5+s),c=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,t>>8,t&255,0,0,e>>8,e&255,8,6,0,0,0,0,0,0,0,r>>>24,r>>16&255,r>>8&255,r&255,73,68,65,84,120,1],i=[0,498536548,997073096,651767980,1994146192,1802195444,1303535960,1342533948,-306674912,-267414716,-690576408,-882789492,-1687895376,-2032938284,-1609899400,-1111625188];let a=1,n=0;for(let f=0,u=0,l=s-1;f<e;f++,l+=s-1)for(c.push(f+1<e?0:1,s&255,s>>8,~s&255,s>>8^255,0),n=(n+a)%65521;u<l;u++){const m=o[u]&255;c.push(m),a=(a+m)%65521,n=(n+a)%65521}c.push(n>>8,n&255,a>>8,a&255,0,0,0,0,0,0,0,0,73,69,78,68,174,66,96,130);for(let[f,u]of[[12,29],[37,41+r]]){let l=-1;for(let m=f;m<u;m++)l^=c[m],l=l>>>4^i[l&15],l=l>>>4^i[l&15];l=~l,c[u++]=l>>>24,c[u++]=l>>16&255,c[u++]=l>>8&255,c[u++]=l&255}return`data:image/png;base64,${globalThis.btoa(String.fromCharCode(...c))}`}const ht=new Uint8Array(128);for(let t=0;t<83;t++)ht["0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~".charCodeAt(t)]=t;const Y=(t,e,o)=>{let s=0;for(;e<o;)s*=83,s+=ht[t.charCodeAt(e++)];return s},mt=Math.pow,U=Math.PI,xt=U*2,yt=3294.6,gt=269.025,St=t=>t>10.31475?mt(t/gt+.052132,2.4):t/yt,Z=t=>~~(t>1227e-8?gt*mt(t,.416666)-13.025:t*yt+1),I=t=>(t<0?-1:1)*t*t,nt=t=>{for(t+=U/2;t>U;)t-=xt;const e=1.27323954*t-.405284735*I(t);return .225*(I(e)-e)+e};function Et(t){const e=Y(t,2,6);return[e>>16,e>>8&255,e&255]}function jt(t,e,o,s){const r=Y(t,0,1),c=r%9+1,i=~~(r/9)+1,a=c*i;let n=0,p=0,f=0,u=0,l=0,m=0,R=0,b=0,x=0,g=0,A=0,S=0;const P=(Y(t,1,2)+1)/13446*(s|1),_=new Float64Array(a*3),E=Et(t);for(n=0;n<3;n++)_[n]=St(E[n]);for(n=1;n<a;n++)S=Y(t,4+n*2,6+n*2),_[n*3]=I(~~(S/361)-9)*P,_[n*3+1]=I(~~(S/19)%19-9)*P,_[n*3+2]=I(S%19-9)*P;const O=new Float64Array(i*o),D=new Float64Array(c*e);for(p=0;p<i;p++)for(u=0;u<o;u++)O[p*o+u]=nt(U*u*p/o);for(n=0;n<c;n++)for(f=0;f<e;f++)D[n*e+f]=nt(U*f*n/e);const G=e*4,w=new Uint8ClampedArray(G*o);for(u=0;u<o;u++)for(f=0;f<e;f++){for(l=m=R=0,p=0;p<i;p++)for(x=O[p*o+u],n=0;n<c;n++)b=D[n*e+f]*x,g=(n+p*c)*3,l+=_[g]*b,m+=_[g+1]*b,R+=_[g+2]*b;A=4*f+u*G,w[A]=Z(l),w[A+1]=Z(m),w[A+2]=Z(R),w[A+3]=255}return w}const K=32,Ct="data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3C/svg%3E";function Rt(t,{ratio:e=1,size:o=K}={}){const{width:s,height:r}=Pt(e,o),c=jt(t,s,r);return pt(s,r,c)}function Pt(t,e){const o=t>=1;return{width:o?e:Math.round(e*t),height:o?Math.round(e/t):e}}function qt(t){let{PI:e,min:o,max:s,cos:r,round:c}=Math,i=t[0]|t[1]<<8|t[2]<<16,a=t[3]|t[4]<<8,n=(i&63)/63,p=(i>>6&63)/31.5-1,f=(i>>12&63)/31.5-1,u=(i>>18&31)/31,l=i>>23,m=(a>>3&63)/63,R=(a>>9&63)/63,b=a>>15,x=s(3,b?l?5:7:a&7),g=s(3,b?a&7:l?5:7),A=l?(t[5]&15)/15:1,S=(t[5]>>4)/15,P=l?6:5,_=0,E=(H,v,N)=>{let j=[];for(let L=0;L<v;L++)for(let C=L?0:1;C*v<H*(v-L);C++)j.push(((t[P+(_>>1)]>>((_++&1)<<2)&15)/7.5-1)*N);return j},O=E(x,g,u),D=E(3,3,m*1.25),G=E(3,3,R*1.25),w=l&&E(5,5,S),z=Ht(t),W=c(z>1?32:32*z),$=c(z>1?32/z:32),q=new Uint8Array(W*$*4),M=[],B=[];for(let H=0,v=0;H<$;H++)for(let N=0;N<W;N++,v+=4){let j=n,L=p,C=f,et=A;for(let d=0,h=s(x,l?5:3);d<h;d++)M[d]=r(e/W*(N+.5)*d);for(let d=0,h=s(g,l?5:3);d<h;d++)B[d]=r(e/$*(H+.5)*d);for(let d=0,h=0;d<g;d++)for(let y=d?0:1,T=B[d]*2;y*g<x*(g-d);y++,h++)j+=O[h]*M[y]*T;for(let d=0,h=0;d<3;d++)for(let y=d?0:1,T=B[d]*2;y<3-d;y++,h++){let rt=M[y]*T;L+=D[h]*rt,C+=G[h]*rt}if(l)for(let d=0,h=0;d<5;d++)for(let y=d?0:1,T=B[d]*2;y<5-d;y++,h++)et+=w[h]*M[y]*T;let ot=j-2/3*L,st=(3*j-ot+C)/2,Lt=st-C;q[v]=s(0,255*o(1,st)),q[v+1]=s(0,255*o(1,Lt)),q[v+2]=s(0,255*o(1,ot)),q[v+3]=s(0,255*o(1,et))}return{w:W,h:$,rgba:q}}function Ht(t){let e=t[3],o=t[2]&128,s=t[4]&128,r=s?o?5:7:e&7,c=s?e&7:o?5:7;return r/c}function Nt(t){const e=Tt(t),{w:o,h:s,rgba:r}=qt(e);return pt(o,s,r)}function Tt(t){return Uint8Array.from(globalThis.atob(It(t)),e=>e.charCodeAt(0))}function It(t){return t.replaceAll("-","+").replaceAll("_","/")}const _t=typeof window>"u",Ut=!_t&&"loading"in HTMLImageElement.prototype,Ot=!_t&&(!("onscroll"in window)||/(?:gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent));function Dt(t,e=document){return typeof t=="string"?[...e.querySelectorAll(t)]:t instanceof Element?[t]:[...t]}function Gt(t){const e=Date.now();return Ct.replace(/\s/,` data-id='${e}-${t}' `)}function zt(t,e){let o;return function(...s){o!=null&&clearTimeout(o),o=setTimeout(()=>{t(...s),o=void 0},e)}}function Wt(t='img[loading="lazy"]',{hash:e=!0,hashType:o="blurhash",placeholderSize:s=K,updateSizesOnResize:r=!1,onImageLoad:c}={}){const i=new Set;for(const[a,n]of Dt(t).entries()){const p=X(n,{updateOnResize:r});if(r&&p&&i.add(p),(typeof __UNLAZY_HASH_DECODING__>"u"||__UNLAZY_HASH_DECODING__)&&e){const u=$t({image:n,hash:typeof e=="string"?e:void 0,hashType:o,size:s});u&&(n.src=u)}if(!n.dataset.src&&!n.dataset.srcset){(typeof __UNLAZY_LOGGING__>"u"||__UNLAZY_LOGGING__)&&console.error("[unlazy] Missing `data-src` or `data-srcset` attribute",n);continue}if(Ot||!Ut){vt(n),F(n),k(n);continue}if(n.src||(n.src=Gt(a)),n.complete&&n.naturalWidth>0){ct(n,c);continue}const f=()=>ct(n,c);n.addEventListener("load",f,{once:!0}),i.add(()=>n.removeEventListener("load",f))}return()=>{for(const a of i)a();i.clear()}}function ct(t,e){if(At(t)){vt(t),F(t),k(t),e==null||e(t);return}const o=new Image,{srcset:s,src:r,sizes:c}=t.dataset;if(c==="auto"){const i=bt(t);i&&(o.sizes=`${i}px`)}else t.sizes&&(o.sizes=t.sizes);s&&(o.srcset=s),r&&(o.src=r),o.addEventListener("load",()=>{F(t),k(t),e==null||e(t)},{once:!0})}function $t({image:t,hash:e,hashType:o="blurhash",size:s=K,ratio:r}={}){if(t&&!e){const{blurhash:c,thumbhash:i}=t.dataset;e=i||c,o=i?"thumbhash":"blurhash"}if(e)try{if(o==="blurhash"){if(t&&!r){const c=t.width||t.offsetWidth||s,i=t.height||t.offsetHeight||s;r=c/i}return Rt(e,{ratio:r,size:s})}return Nt(e)}catch(c){(typeof __UNLAZY_LOGGING__>"u"||__UNLAZY_LOGGING__)&&console.error(`[unlazy] Failed to generate ${o} placeholder:`,c)}}const V=new WeakMap;function X(t,e){if(t.dataset.sizes!=="auto")return;const o=bt(t);if(o&&(t.sizes=`${o}px`),At(t)&&(e!=null&&e.processSourceElements))for(const s of[...t.parentElement.getElementsByTagName("source")])X(s,{processSourceElements:!0});if(e!=null&&e.updateOnResize){if(!V.has(t)){const s=zt(()=>X(t),500),r=new ResizeObserver(s);V.set(t,r),r.observe(t)}return()=>{const s=V.get(t);s&&(s.disconnect(),V.delete(t))}}}function k(t){t.dataset.src&&(t.src=t.dataset.src,t.removeAttribute("data-src"))}function F(t){t.dataset.srcset&&(t.srcset=t.dataset.srcset,t.removeAttribute("data-srcset"))}function vt(t){const e=t.parentElement;(e==null?void 0:e.tagName.toLowerCase())==="picture"&&([...e.querySelectorAll("source[data-srcset]")].forEach(F),[...e.querySelectorAll("source[data-src]")].forEach(k))}function bt(t){var e,o;return t instanceof HTMLSourceElement?(o=(e=t.parentElement)==null?void 0:e.getElementsByTagName("img")[0])==null?void 0:o.offsetWidth:t.offsetWidth}function At(t){var e;return((e=t.parentElement)==null?void 0:e.tagName.toLowerCase())==="picture"}Wt();document.firstElementChild.classList.remove("no-js");document.firstElementChild.classList.add("js");const it=document.querySelectorAll(".text"),at=document.querySelectorAll(".text__ani"),lt=document.querySelectorAll(".text__ani__start");let dt;const Mt=100,ut=100;function Bt(){for(let t=0;t<lt.length;t++)dt="text__ani__start",ft(t,lt,dt,ut);window.innerWidth<800?setTimeout(()=>{for(let t=0;t<at.length;t++)ft(t,at,"text__ani",Mt)},1e3):setTimeout(()=>{for(let t=0;t<it.length;t++){const e=it[t].querySelectorAll(".text__ani");(()=>{for(let o=0;o<e.length;o++)setTimeout(()=>{e[o].classList.remove("text__ani")},o*ut)})()}},1e3)}Bt();function ft(t,e,o,s){setTimeout(()=>{e[t].classList.remove(o)},s*t)}function Vt(t){let e=0;const o=new ResizeObserver(s=>{for(const r of s)if(r.target.style.setProperty("--caption-open-height",`${r.target.childNodes[1].offsetHeight+16}px`),o.unobserve(r.target),e+=1,e===t.length)for(const c of t)c.style.setProperty("--caption-desc-height","0px")});for(const s of t)o.observe(s)}document.addEventListener("DOMContentLoaded",async()=>{tt.initAll();const t=document.querySelectorAll("[data-caption]");Vt(t),kt(),await Q();const e=document.querySelectorAll("[data-project]");for(const o of e)wt.observe(o)});const wt=new IntersectionObserver(t=>{for(const e of t)if(e.isIntersecting){e.target.classList.add("visible");const o=document.querySelector("video");o&&!e.target.classList.contains("faded")&&o.play(),wt.unobserve(e.target)}},{root:null,rootMargin:"0px",threshold:0});async function Q(t){const o=new URLSearchParams(window.location.search).get("project"),s=document.querySelectorAll("[data-project]");if(o)for(const r of s){const c=r.querySelector("video");r.dataset.project!==o?(r.classList.add("faded"),r.classList.remove("isolated"),c&&c.pause()):(r.classList.remove("faded"),r.classList.add("isolated"),c&&c.play()),r===t?r.classList.add("show--description"):r.classList.remove("show--description")}else for(const r of s){const c=r.querySelector("video");r.classList.remove("faded"),r.classList.remove("isolated"),r.classList.remove("show--description"),c&&c.play()}if(!t&&o){const r=document.querySelector(`[data-project="${o}"]`);r.scrollIntoView({behavior:"instant",block:"center",inline:"center"}),r.classList.add("show--description")}}function J(t){const e=new URL(window.location);t?e.searchParams.set("project",t):e.searchParams.delete("project"),history.replaceState(null,"",e)}document.addEventListener("click",t=>{const o=new URLSearchParams(window.location.search).get("project");if(o){const s=t.target.closest(`[data-project=${o}]`);(!s||s.dataset.project!==o)&&(J(null),Q(null))}},!0);const Yt=document.querySelectorAll("[data-project]");for(const t of Yt)t.addEventListener("click",()=>{const e=t.dataset.project,s=new URLSearchParams(window.location.search).get("project"),r=t.querySelector("[data-caption-desc]");s===e?(r.style.setProperty("--caption-desc-height","0px"),J(null)):(r.style.setProperty("--caption-desc-height","auto"),J(e)),Q(t)});function kt(){const t=document.querySelectorAll("[data-isolate-project]"),e={};for(const o of t){const s=o.getAttribute("data-isolate-project");e[s]=(e[s]||0)+1}for(const o of t){const s=o.getAttribute("data-isolate-project"),r=e[s],c=[...t].filter(a=>a.getAttribute("data-isolate-project")===s).indexOf(o)+1,i=o.querySelector(".caption__right__count");i&&(i.textContent=`${c} / ${r}`)}}class tt{constructor(e){this.container=e,this.resolutions=this.parseResolutions(),this.placeholder=this.container.querySelector("img"),this.videoWidth=Number.parseInt(this.container.dataset.width||"0"),this.videoHeight=Number.parseInt(this.container.dataset.height||"0"),this.init()}parseResolutions(){const e=this.container.dataset.resolutions;return e?e.split(",").map(o=>o.trim()):[]}extractResolution(e){const o=e.match(/_(\d+)p\.mp4$/);return o?Number.parseInt(o[1]):0}calculateVideoAspectRatio(){return this.videoWidth<=0||this.videoHeight<=0?1:this.videoHeight/this.videoWidth}calcHeight(e){const o=this.calculateVideoAspectRatio();return e*o}getLongest(e,o){return e>o?e:o}findIdealResolution(e,o,s){const r=o*s;return e.reduce((i,a)=>{const n=Math.abs(a.longest-r),p=Math.abs(i.longest-r);return n<p?a:i})}getIdealResolution(){const e=window.devicePixelRatio||1,o=this.container.clientWidth,s=this.container.clientHeight,r=this.getLongest(s,o),c=this.resolutions.map(a=>{const n=this.extractResolution(a),p=this.calcHeight(n),f=this.getLongest(p,n);return{filename:a,resolution:n,width:n,height:p,longest:f}}).sort((a,n)=>a.resolution-n.resolution);return c.length===0?(console.error("No valid video resolutions found"),null):(this.findIdealResolution(c,r,e)||c[c.length-1]).resolution}createVideoElement(e){if(e===null){const i=this.resolutions.map(a=>this.extractResolution(a)).filter(a=>a>0);e=Math.max(...i)}const o=this.resolutions.find(i=>this.extractResolution(i)===e);if(!o)return console.error(`No video found for resolution ${e}p`),null;const s=document.createElement("video");s.src=o,s.poster=this.placeholder.src,s.className=this.container.className,this.videoWidth>0&&this.videoHeight>0&&s.style.setProperty("--_aspect-ratio",`${this.videoWidth} / ${this.videoHeight}`);const r=(this.container.dataset.attributes||"").split(",").map(i=>i.trim().toLowerCase()).filter(i=>i);r.includes("controls")&&(s.controls=!0),r.includes("muted")&&(s.muted=!0),r.includes("playsinline")&&s.setAttribute("playsinline",""),r.includes("autoplay")&&(s.autoplay=!0),r.includes("loop")&&(s.loop=!0);const c=this.container.dataset.preload;c&&(s.preload=c);for(const i of Array.from(this.placeholder.attributes))i.name!=="src"&&s.setAttribute(i.name,i.value);return s}init(){this.loadOptimalVideo()}loadOptimalVideo(){const e=this.getIdealResolution(),o=this.createVideoElement(e);o&&(this.placeholder?this.placeholder.replaceWith(o):this.container.appendChild(o))}static initAll(e="[data-resolutions]"){for(const o of document.querySelectorAll(e))new tt(o)}}
